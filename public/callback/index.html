<!doctype html>
<html>
  <head>
    <title>Spotify 인증 완료</title>
  </head>
  <body>
    <h1>인증 처리 중...</h1>

    <script>
      // URL에서 코드 파라미터 추출
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      const error = urlParams.get('error');

      if (error) {
        document.body.innerHTML = `<h1>오류 발생</h1><p>${error}</p>`;
      } else if (code) {
        document.body.innerHTML = `<h1>인증 코드 받음</h1><p>홈으로 이동합니다...</p>`;

        // 코드를 로컬 스토리지에 저장 - 키 이름 변경
        localStorage.setItem('spotify_code', code);

        // 1초 후 홈으로 이동
        setTimeout(() => {
          window.location.href = '/';
        }, 1000);
      } else {
        document.body.innerHTML = '<h1>인증 코드가 없습니다</h1>';
      }
    </script>
  </body>
</html>
